<apam xmlns="fr.imag.adele.apam" xmlns:ipojo="org.apache.felix.ipojo"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ev="org.apache.felix.ipojo.handlers.event"
      xsi:schemaLocation="fr.imag.adele.apam http://repository-apam.forge.cloudbees.com/release/schema/ApamCore.xsd
	 org.apache.felix.ipojo http://felix.apache.org/ipojo/schemas/CURRENT/core.xsd org.apache.felix.ipojo.handlers.event http://felix.apache.org/ipojo/schemas/CURRENT/event-admin.xsd">

    <specification name="ARDWatchDogSpec"
                   interfaces="appsgate.ard.protocol.spec.ARDWatchDogSpec, appsgate.lig.core.object.spec.CoreObjectSpec"
                   messages="appsgate.lig.core.object.messages.NotificationMsg">

        <!-- device kernel meta data -->
        <definition name="deviceName" type="string" />
        <definition name="deviceId" type="string" />
        <definition name="deviceType" type="string" />

        <!-- device client meta data -->
        <definition name="pictureId" type="string" />
        <definition name="userType" type="string" />
        <definition name="status" type="string" />

        <!-- device specific meta data -->
        <definition name="currentStatus" type="string" />

    </specification>

    <implementation name="ARDContactSensorImpl" classname="appsgate.ard.protocol.adaptor.ARDWatchDog" specification="ARDWatchDogSpec"  push="triggerApamMessage">
        <callback onInit="newInst" onRemove="deleteInst" />
    </implementation>

    <implementation name="ARDMessageGreedyListener" classname="appsgate.ard.protocol.ARDMessageGreedyListener">
        <relation push="apamMessageReceived" resolve="exist" multiple="true" />
        <callback onInit="start" onRemove="stop" />
    </implementation>


    <implementation name="ARDAdaptor" classname="appsgate.ard.protocol.adaptor.ARDAdaptor" > <!--push="notifyChanges"-->

        <definition name="server" field="server" type="string" />
        <property name="server" value="192.168.3.110" />
        <callback onInit="validate" onRemove="invalidate"/>

    </implementation>

    <apam-instance implementation="ARDMessageGreedyListener" name="ARDApamAdaptorInstance"/>
    <apam-instance implementation="ARDAdaptor" name="ARDAdaptorInstance"/>

</apam>
